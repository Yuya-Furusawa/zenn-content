---
title: "Next.jsã§ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€"
emoji: "âœ¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs", "react", "typescript"]
published: false
---

Reactã‚„Vueãªã©ã§ãƒšãƒ¼ã‚¸ã«ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€ã«ã¯åŸºæœ¬çš„ã«ã¯ä»¥ä¸‹ã®è¨˜äº‹ã®é€šã‚Šã«ã‚„ã‚Œã°OKã§ã™ã€‚

https://zenn.dev/catnose99/articles/329d7d61968efb

ã—ã‹ã—ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ„ã‚¤ãƒ¼ãƒˆã®IDã‚’propsã¨ã—ã¦æ¸¡ã›ã‚‹ã‚ˆã†ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚ŠãŸã‹ã£ãŸã®ã§ãã®å®Ÿè£…æ–¹æ³•ã‚’èª¿ã¹ã¾ã—ãŸã€‚åŠ ãˆã¦ã€è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§Next.jsã‚’ä½¿ã£ã¦ã„ã‚‹ãŸã‚Next.jsã§ã®å…·ä½“çš„ãªå®Ÿè£…ã«é–¢ã—ã¦ã‚‚ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```tsx
// ç›®æ¨™ã¨ãªã‚‹å®Ÿè£…
<EmbeddedTweet id={'hogehoge'} />
```

# æ–¹æ³•1: react-twitter-embedãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†

react-twitter-embedã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚‹ã®ã§ã€ã“ã‚Œã‚’ä½¿ãˆã°ç°¡å˜ã«åŸ‹ã‚è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

https://www.npmjs.com/package/react-twitter-embed

```tsx
import { TwitterTweetEmbed } from 'react-twitter-embed';

type Props = {
  tweetId: string
}

const EmbeddedTweet: React.FC<Props> = ({ tweetId }) => {
  return (
    <TwitterTweetEmbed
      id={tweetId}
    />
  );
};
```

ã“ã‚Œã§ã‚‚å•é¡Œç„¡ã„ã®ã§ã™ãŒã€ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã ã¨ä¾‹ãˆã°åŸ‹ã‚è¾¼ã‚“ã ãƒ„ã‚¤ãƒ¼ãƒˆã®widthã‚’æŒ‡å®šã§ããªã„ãªã©ï¼ˆ[issue](https://github.com/saurabhnemade/react-twitter-embed/issues/113)ï¼‰ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è‡ªç”±ã«å½“ã¦ã‚‹ã“ã¨ãŒã§ããšæ­£ç›´ä½¿ã„ã«ãã„ã¨ã„ã†å°è±¡ã ã£ãŸã®ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«é ¼ã‚‰ãšè‡ªåˆ†ã§å®Ÿè£…ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

# æ–¹æ³•2: createTweetã‚’ä½¿ã†

developer.twitterã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹é€šã‚Šã€`createTweet`ã‚’ä½¿ãˆã°ãƒ„ã‚¤ãƒ¼ãƒˆIDã‹ã‚‰ç›´æ¥ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-javascript-factory-function


ï¼‘ã¤æ³¨æ„ç‚¹ã¨ã—ã¦ã€`createTweet`ã‚’ä½¿ã†ã«ã¯`widget.js`ã‚’äºˆã‚èª­ã¿è¾¼ã‚“ã§ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚‚ã—ãã¯ã€è¤‡æ•°ãƒšãƒ¼ã‚¸ã§ãƒ„ã‚¤ãƒ¼ãƒˆã®åŸ‹ã‚è¾¼ã¿ã‚’è¡Œã†å ´åˆã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ã‚ˆã†ãªã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ç”¨ã„ã‚‹ã®ã‚‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è¦³ç‚¹ã‹ã‚‰è‰¯ã„ã¿ãŸã„ã§ã™ã€‚

```js
<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>
```

ç§ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯è¤‡æ•°ãƒšãƒ¼ã‚¸ã§ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€ãŸã‚ã€å¾Œè€…ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ä½¿ã†æ–¹æ³•ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚

Next.jsã®å ´åˆã€`pages/_document.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦èª­ã¿è¾¼ã‚“ã§ãŠãã¾ã™ã€‚ã“ã‚Œã§ã‚¹ãƒ‹ãƒšãƒƒãƒˆãŒ`<head>`ã®ä¸­ã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

```tsx:_document.tsx
import Script from 'next/script';
import { Html, Head, Main, NextScript } from 'next/document';

export default function Document() {
  return (
    <Html>
      <Head>
        <Script
          strategy='beforeInteractive'
          dangerouslySetInnerHTML={{
            __html: `
            window.twttr = (function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0],
                t = window.twttr || {};
              if (d.getElementById(id)) return t;
              js = d.createElement(s);
              js.id = id;
              js.src = "https://platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js, fjs);

              t._e = [];
              t.ready = function(f) {
                t._e.push(f);
              };

              return t;
            }(document, "script", "twitter-wjs"));
            `,
          }}
        />
      </Head>
      <body>
        <Main />
        <NextScript />
      </body>
    </Html>
  );
}
```

æº–å‚™ãŒã§ããŸã®ã§`createTweet`ã‚’ä½¿ã£ã¦ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ãã¾ã™ã€‚
`createTweet`ã¯ï¼“ã¤ã®å¼•æ•°ã‚’å–ã‚Šã¾ã™ã€‚

1. ãƒ„ã‚¤ãƒ¼ãƒˆã®ID
2. ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€DOMã®ãƒãƒ¼ãƒ‰
3. ï¼ˆoptionalï¼‰ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³

2ã¤ç›®ã«é–¢ã—ã¦ã€`useRef`ã‚’ä½¿ã£ã¦DOMãƒãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚
3ã¤ç›®ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯[ã“ã¡ã‚‰](https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-parameter-reference)ã§è¦‹ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚Œã°ç›®æ¨™ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```tsx:EmbeddedTwitter.tsx
import * as React from 'react';

import styles from './EmbeddedTwitter.module.scss';

type Props = {
  tweetId: string
}

const EmbeddedMovie: React.FC<Props> = ({ tweetId }) => {
  const ref = React.useRef<HTMLDivElement | null>(null);

  React.useEffect(() => {
    window.twttr.widgets.createTweet(
      tweetId,
      ref?.current,
      {
        conversation: 'none'
      }
    );
  }, []);

  return (
    <div className={styles.hoge}>
      <div ref={ref} className={styles.fuga} />
    </div>
  );
};

export default EmbeddedMovie;
```

ç›®æ¨™ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸğŸ‘
ãƒ„ã‚¤ãƒ¼ãƒˆã‚’åŸ‹ã‚è¾¼ã‚“ã DOMã«ç›´æ¥ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å½“ã¦ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã®ã§æº€è¶³ã§ã™ã€‚


### è£œè¶³

TypeScriptã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã€ã‚‚ã—ã‹ã—ãŸã‚‰ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

```
Property 'twttr' does not exist on type 'Window & typeof globalThis'.
```

`window.twttr`ã¯å¤–éƒ¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ã®ã§ã¾ã‚ãã†ãªã‚Šã¾ã™ã­ã€‚
ã“ã®å ´åˆã€å‹ã®declareã‚’è¡Œã„ã¾ã™ã€‚ç°¡å˜ã«ã‚¨ãƒ©ãƒ¼ã‚’ç›´ã™ãªã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```ts:global.d.ts
export {}

declare global {
  interface Window {
    twttr: any,
  }
}
```
